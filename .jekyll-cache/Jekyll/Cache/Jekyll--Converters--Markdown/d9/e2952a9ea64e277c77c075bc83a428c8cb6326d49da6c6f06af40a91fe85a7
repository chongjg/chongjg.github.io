I"·r<ul>
  <li>ï¼ˆæ•°å­—å›¾åƒå¤„ç†çš„ç¬¬ä¸€ä¸ªä½œä¸šï¼Œç»“æœæ˜¯èµ¶ç€å®Œæˆçš„ï¼Œçœ‹ä¸¤ç¯‡è®ºæ–‡å¹¶ä¸”å®ç°æäº†å…«ä¸ªå°æ—¶ï¼Œæœ€åå‰©ä¸¤ä¸ªå°æ—¶å†™æŠ¥å‘Šï¼Œæ·±æ·±ä¸ºè‡ªå·±è‹±æ–‡æ°´å¹³ç€æ€¥ï¼Œè‰è‰ç»“å°¾è¿˜æ™šäº¤äº†å‡ åˆ†é’Ÿã€‚è£‚å¼€æ¥ã€‚</li>
</ul>

<h2 id="1histogram-equalization">1.Histogram Equalization</h2>

<ul>
  <li>
    <p>è¿™ä¸ªç®—æ³•ç®€ç§°<strong>HE</strong>æˆ–è€…<strong>GHE(Global ~)</strong></p>
  </li>
  <li>
    <p>ç®—æ³•çš„æ€æƒ³éå¸¸ç®€å•ï¼Œä¸€ä¸ªç°åº¦å›¾çš„ç›´æ–¹å›¾å¾€å¾€æ˜¯ä¸å‡åŒ€çš„ï¼Œè¿™æ ·å¯¹æ¯”åº¦å¾€å¾€ä¸é«˜ï¼Œæˆ‘ä»¬è¦æ˜¯èƒ½å¤Ÿä½¿å®ƒçš„ç›´æ–¹å›¾å˜å¾—æ›´åŠ å‡åŒ€ï¼ˆæ¯”å¦‚æ¯ä¸ªç°åº¦å€¼çš„åƒç´ ä¸ªæ•°ä¸€æ ·ï¼Œå®ƒçš„å¯¹æ¯”åº¦åº”è¯¥ä¼šæ¯”è¾ƒå¥½ï¼‰ã€‚</p>
  </li>
  <li>
    <p>ä¸‹é¢æ˜¯åœ¨ç½‘ä¸Šæ‰¾çš„ä¸€å¼ å›¾ç‰‡ä»¥åŠå®ƒçš„ç›´æ–¹å›¾ã€‚</p>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/origin.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/origin-hist.jpg" alt="" /></p>

<ul>
  <li>
    <p>ä»ä¸Šå›¾çš„ç›´æ–¹å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåƒç´ çš„åˆ†å¸ƒéå¸¸ä¸å‡åŒ€ï¼Œç»å¤§å¤šæ•°åƒç´ éƒ½æ˜¯ç°åº¦å€¼å¾ˆå°çš„ã€‚</p>
  </li>
  <li>
    <p>é€šä¿—åœ°è®²ï¼Œ<strong>HE</strong>ç®—æ³•çš„æ€æƒ³å°±æ˜¯è®©ç›´æ–¹å›¾ä¸­æ¯ä¸ªæŸ±å­è¿›è¡Œä¸æ”¹å˜é¡ºåºçš„ç§»åŠ¨ï¼ˆå¯ä»¥åˆå¹¶ï¼Œä¸èƒ½æ‹†åˆ†ï¼‰ï¼Œä½¿å¾—æ¯ä¸ªæŸ±å­çš„é«˜åº¦å’Œå®ƒå ç”¨çš„ç°åº¦æ•°ç›¸å½“ã€‚</p>
  </li>
  <li>
    <p>ä»ç®—æ³•å®ç°ä¸Šè®²ï¼Œä»¤<script type="math/tex">cnt(i),(0\leq i\leq 255)</script>è¡¨ç¤ºå›¾åƒæ¯ä¸ªç°åº¦å€¼çš„åƒç´ æ•°é‡ï¼Œ<script type="math/tex">sum(i)</script>æ˜¯<script type="math/tex">cnt</script>çš„å‰ç¼€å’Œã€‚é‚£ä¹ˆåªéœ€è¦æŠŠåŸæœ¬çš„ç°åº¦å€¼<script type="math/tex">i</script>æ”¹æˆæ–°çš„ç°åº¦å€¼<script type="math/tex">sum(i)*255/sum(N)</script>å³å¯ã€‚</p>
  </li>
  <li>
    <p>ç®—æ³•çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º</p>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/GHE.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/GHE-hist.jpg" alt="" /></p>

<ul>
  <li>
    <p>å¯ä»¥æ˜æ˜¾åœ°çœ‹åˆ°ç›´æ–¹å›¾çš„æŸ±å­è¢«ç§»åŠ¨å¾—æ›´å‡åŒ€äº†ï¼Œä¹Ÿå°±æ˜¯æŸ±å­çš„é«˜åº¦å’Œå çš„ç°åº¦æ•°æˆæ­£æ¯”äº†ã€‚</p>
  </li>
  <li>
    <p>ç„¶è€Œï¼Œä¹Ÿå¯ä»¥æ˜æ˜¾çœ‹åˆ°è¿™ä¸ªç®—æ³•çš„ä¸è¶³ï¼Œå›¾åƒæ˜æš—åˆ†ç•Œå¤„å¯¹æ¯”åº¦è¢«è¿‡åˆ†å¢å¼ºï¼Œè€Œæ˜å’Œæš—å„è‡ªå†…éƒ¨çš„å¯¹æ¯”åº¦å¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„å¢å¼ºã€‚ä»ç›´æ–¹å›¾ä¸Šå¯ä»¥çœ‹å‡ºæ¥ï¼Œä½¿ç”¨HEç®—æ³•æ—¶ï¼Œå¦‚æœå›¾åƒä¸­å­˜åœ¨éå¸¸å¤šçš„æŸä¸ªç°åº¦å€¼çš„åƒç´ ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´éå¸¸å¤šçš„ç°åº¦å€¼ä¸èƒ½è¢«ä½¿ç”¨ï¼Œä»è€Œæœ‰äº›åœ°æ–¹å¯¹æ¯”åº¦è¿‡å¤§æ˜¾å¾—ä¸è‡ªç„¶ï¼Œè€Œæœ‰çš„åœ°æ–¹å¯¹æ¯”åº¦åˆæ²¡èƒ½å¾—åˆ°å¾ˆå¥½çš„æé«˜ã€‚</p>
  </li>
  <li>
    <p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæŠŠâ€œæŸ±å­â€æ‹†åˆ†çš„æ–¹æ³•ã€‚</p>
  </li>
</ul>

<h2 id="2neighborhood-metrics">2.Neighborhood Metrics</h2>

<ul>
  <li>
    <p>è¿™ä¸€éƒ¨åˆ†å†…å®¹æ¥è‡ªè®ºæ–‡<a href="https://www.researchgate.net/publication/224209864_Image_Contrast_Enhancement_using_Bi-Histogram_Equalization_with_Neighborhood_Metrics?enrichId=rgreq-319bc3ef6eb4fa0f9f562c5ffd925e65-XXX&amp;enrichSource=Y292ZXJQYWdlOzIyNDIwOTg2NDtBUzo0NTY1MTE5MTU4NTk5NjhAMTQ4NTg1MjMzMDAzOQ%3D%3D&amp;el=1_x_3&amp;_esc=publicationCoverPdf">Image Contrast Enhancement using Bi-Histogram Equalization with Neighborhood Metrics</a></p>
  </li>
  <li>
    <p>è€ƒè™‘å¦‚ä½•æ‹†åˆ†æŸ±å­ï¼Œå®é™…ä¸Šå°±æ˜¯è€ƒè™‘æ€ä¹ˆç»™æŸ±å­é‡ŒåŒ…å«çš„åƒç´ åˆ†é…æƒå€¼è¿›è¡Œä¸€ä¸ªæ’åºï¼Œç„¶ååˆ†é…ç°åº¦å€¼çš„æ—¶å€™å°±å¯ä»¥ä¸ç”¨å…¨åˆ†é…ä¸€ä¸ªï¼Œè€Œä¸”å¯ä»¥æŒ‰ç…§æƒå€¼æŒ¨ä¸ªåˆ†é…æ›´å¥½åœ°åˆ©ç”¨ç°åº¦å€¼æé«˜å¯¹æ¯”åº¦ã€‚</p>
  </li>
</ul>

<h4 id="21-voting-metric">2.1 Voting Metric</h4>

<ul>
  <li>
    <p>è¿™æ˜¯è®ºæ–‡ä¸­æåˆ°ç¬¬ä¸€ä¸ªç®—æ³•ï¼Œå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯çœ‹è‡ªå·±çš„å‘¨å›´<script type="math/tex">8</script>ä¸ªåƒç´ ï¼Œæ¯”è‡ªå·±é»‘çš„æœ‰å¤šå°‘ä¸ªï¼Œæœ¬ç€æé«˜å¯¹æ¯”åº¦çš„åŸåˆ™ï¼Œå‘¨å›´æ¯”è‡ªå·±é»‘çš„è¶Šå¤šï¼Œå°±åº”è¯¥åœ¨æŸ±å­é‡Œå°½é‡åˆ†é…æ›´ç™½çš„é¢œè‰²ã€‚</p>
  </li>
  <li>
    <p>å¯ä»¥çœ‹ä½œæ¯ä¸ªåƒç´ æœ‰äº†ä¸€ä¸ªæƒå€¼ï¼Œç„¶åæ¯ä¸ªæŸ±å­æ ¹æ®æƒå€¼å†…éƒ¨æ’åºï¼Œæ¯ä¸ªæŸ±å­æœ€å¤šæ‹†åˆ†æˆ<script type="math/tex">9</script>æ®µï¼ˆæ‹†åˆ†æ•ˆæœå¦‚ä¸‹å›¾ï¼‰ï¼Œä¹‹åå†å¯¹è¿™äº›æ‹†åˆ†çš„æŸ±å­è¿›è¡ŒHEç®—æ³•å³å¯ã€‚</p>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/Voting-1.png" alt="" /></p>

<ul>
  <li>æŒ‰ç…§ä¸Šè¿°æ€æƒ³å¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“æœ</li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/HE-Voting.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/HE-Voting-hist.jpg" alt="" /></p>

<ul>
  <li>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™å¹…å›¾ä¸­ï¼Œæœ€é«˜çš„æŸ±å­é«˜åº¦åŸºæœ¬æ²¡å˜ï¼Œè¿™æ˜¯å› ä¸ºçº¯é»‘å‘¨å›´ä¸ä¼šæœ‰æ¯”å®ƒé»‘çš„ï¼Œæ‰€ä»¥çº¯é»‘çš„æŸ±å­åœ¨è¿™ä¸ªç®—æ³•ä¸‹æ— æ³•è¢«æ‹†åˆ†ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ç°åº¦å€¼è¾ƒå¤§çš„åŒºåŸŸå¾—åˆ°äº†ä¸€å®šçš„å¹³æ»‘ã€‚ä¸è¿‡ä»å›¾ç‰‡ä¸Šæ¥è¯´æ²¡æœ‰è‚‰çœ¼å¯è§å˜åŒ–ã€‚</li>
</ul>

<h4 id="22-contrast-difference-metric">2.2 Contrast Difference Metric</h4>

<ul>
  <li>
    <p>è¿™ä¸ªç®—æ³•æ˜¯åœ¨åˆšåˆšç®—æ³•çš„åŸºç¡€ä¸Šè¿›è¡Œå†æ¬¡æ‹†åˆ†ï¼Œ<script type="math/tex">2.1</script>èƒ½å¤ŸæŠŠä¸€ä¸ªæŸ±å­æ‹†æˆæœ€å¤š<script type="math/tex">9</script>ä¸ªï¼Œè€Œè¿™ä¸ªç®—æ³•åœ¨åˆšåˆš<strong>æ‹†åˆ†å®Œçš„åŸºç¡€ä¸Š</strong>å†è¿›è¡Œæ‹†åˆ†ã€‚</p>
  </li>
  <li>
    <p>è¿™ä¸ªç®—æ³•æ˜¯è®¡ç®—å‘¨å›´æ¯”è‡ªå·±ç°åº¦å€¼å°çš„åƒç´ å¹³å‡æ¯”è‡ªå·±å°å¤šå°‘ï¼Œä»¥åŠæ¯”è‡ªå·±å¤§çš„åƒç´ å¹³å‡æ¯”è‡ªå·±å¤§å¤šå°‘ï¼Œåˆ†åˆ«è®°ä½œ<script type="math/tex">left\;average\;difference(L.a.d)</script>å’Œ<script type="math/tex">right\;average\;difference(R.a.d)</script>ã€‚</p>
  </li>
  <li>
    <p>è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œå½“<script type="math/tex">% <![CDATA[
L.a.d<Threshold<R.a.d %]]></script>æ—¶æƒå€¼è®¾ç½®ä¸º<script type="math/tex">1</script>ï¼Œå½“<script type="math/tex">L.a.d>Threshold>R.a.d</script>æ—¶æƒå€¼è®¾ç½®ä¸º<script type="math/tex">3</script>ï¼Œå¦åˆ™ä¸º<script type="math/tex">2</script>ã€‚</p>
  </li>
  <li>
    <p>æ‹†åˆ†æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º</p>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/Contrast-1.png" alt="" /></p>

<ul>
  <li>æŒ‰ç…§ä¸Šè¿°æ€æƒ³å®ç°ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“æœ</li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/HE-Contrast.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/HE-Contrast-hist.jpg" alt="" /></p>

<ul>
  <li>ç„¶è€Œå¾ˆä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªæ”¹è¿›æ•ˆæœç”šå¾®ï¼Œå‡ ä¹çœ‹ä¸åˆ°ä¸€ç‚¹å·®åˆ«ã€‚</li>
</ul>

<h4 id="23-neighborhood-distinction-metric">2.3 Neighborhood Distinction Metric</h4>

<ul>
  <li>
    <p>è¿™ä¸ªç®—æ³•ç»¼åˆäº†ä¸Šè¿°ä¸¤ä¸ªç®—æ³•ï¼Œç»™å‡ºä¸€ä¸ªæ›´åŠ ç®€å•çš„å®ç°æ–¹å¼ã€‚ç›´æ¥ç»™æ¯ä¸ªåƒç´ åˆ†é…æƒå€¼ä¸ºå‘¨å›´ç°åº¦å€¼æ¯”å®ƒå°çš„åƒç´ ä¸ä»–å·®çš„å’Œï¼Œè¿™æ ·ä¸€æ¥ä¸€ä¸ªæŸ±å­æœ€å¤šèƒ½å¤Ÿè¢«æ‹†åˆ†ä¸º<script type="math/tex">2041</script>ä¸ªæŸ±å­äº†ã€‚</p>
  </li>
  <li>
    <p>æŒ‰ç…§ä¸Šè¿°æ€æƒ³å®ç°å¾—åˆ°ä»¥ä¸‹ç»“æœ</p>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/HE-Neighborhood.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/HE-Neighborhood-hist.jpg" alt="" /></p>

<ul>
  <li>å¯ä»¥çœ‹åˆ°åœ¨ç›´æ–¹å›¾å³éƒ¨ç”±äºæ›´ç»†çš„æ‹†åˆ†ä½¿å¾—ç°åº¦åˆ†å¸ƒæ›´åŠ çš„å¹³æ»‘äº†ã€‚åªæ˜¯åœ¨å›¾ç‰‡ä¸­ä¾ç„¶æ²¡æœ‰å¤ªå¤šä½“ç°ã€‚</li>
</ul>

<h4 id="24-æ€»ç»“">2.4 æ€»ç»“</h4>

<ul>
  <li>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œä»…ä»…é æ‹†åˆ†æŸ±å­æ¥æé«˜å¯¹æ¯”åº¦æ˜¯ä¸å¤Ÿçš„ï¼Œå½“å›¾ç‰‡ä¸­æŸä¸€äº›åƒç´ ç°åº¦å€¼å…¨éƒ½ä¸€æ ·ï¼Œå´ä¸è¡¨è¾¾ä»»ä½•æ„ä¹‰çš„æ—¶å€™ï¼Œè¿™äº›åƒç´ ä¼šå ç”¨å¤§é‡çš„ç°åº¦å€¼åŒºé—´ï¼Œå´ä¸å¯¹å›¾åƒæ•ˆæœåšå‡ºè´¡çŒ®ã€‚ä¸ºäº†æ”¹å˜è¿™ä¸€çŠ¶å†µï¼Œå°±éœ€è¦æŠŠä¸€äº›ä¸é‡è¦çš„åƒç´ å¿½ç•¥ï¼ŒæŠŠä¸€äº›é‡è¦çš„åƒç´ ç€é‡è€ƒè™‘ã€‚</li>
</ul>

<h2 id="3pixel-weight">3.Pixel Weight</h2>

<ul>
  <li>
    <p>åŸºäº<script type="math/tex">2.4</script>çš„æ€è€ƒï¼ŒåŸæœ¬æˆ‘ä»¬è¿›è¡Œç›´æ–¹å›¾ç»Ÿè®¡æ—¶ï¼Œä¸€ä¸ªåƒç´ ç®—ä¸€ä¸ªï¼Œå¹¶æŒ‰ç…§åƒç´ çš„å¤šå°‘æ¥åˆ’åˆ†åº”è¯¥å å¤šå°‘ç°åº¦å€¼ã€‚ç„¶è€Œä¸€å‰¯å›¾ç‰‡ä¸­å¯èƒ½å¾ˆå¤šåƒç´ éƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ¯”å¦‚ä¸€å¤§å—è¿ç»­çš„é»‘è‰²ï¼Œå°±è®©ä»–ä¿æŒé»‘è‰²å°±æŒºå¥½ï¼Œä¸éœ€è¦è€ƒè™‘æ”¹è¿›å®ƒçš„å¯¹æ¯”åº¦ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç»™åƒç´ å¼•å…¥æƒé‡ï¼Œæœ‰çš„ä¸é‡è¦çš„åƒç´ å¯ä»¥ç®—åŠä¸ªç”šè‡³é›¶ä¸ªï¼Œæœ‰çš„å¾ˆé‡è¦çš„åƒç´ å¯ä»¥ç®—ä¸¤ä¸ªäº”ä¸ªç­‰ç­‰ã€‚äºæ˜¯æƒé‡çš„è®¾ç½®å°±æˆäº†ä¸€ä¸ªç ”ç©¶çš„é—®é¢˜ã€‚</p>
  </li>
  <li>
    <p>è€Œä¸”æœ‰ä¸€ç‚¹å¾ˆé‡è¦çš„æ˜¯ï¼ŒHEä»¥åŠ<script type="math/tex">2.1,2.2</script>çš„ç®—æ³•å’Œæˆ‘ä»¬å¦‚ä½•è®¾ç½®æƒå€¼å¹¶ä¸å†²çªï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥éšæ„åœ°ç»„åˆæ‹†åˆ†æ–¹æ³•å’Œæƒå€¼æ–¹æ³•ã€‚</p>
  </li>
</ul>

<h4 id="31-gradient">3.1 Gradient</h4>

<ul>
  <li>é€šå¸¸è®¤ä¸ºå›¾åƒçš„è¾¹ç¼˜æä¾›ä¿¡æ¯ï¼Œäºæ˜¯å¯ä»¥è€ƒè™‘ä½¿ç”¨æ¢¯åº¦ä½œä¸ºåƒç´ çš„æƒå€¼ã€‚æ‹†åˆ†æ–¹å¼é€‰æ‹©<script type="math/tex">2.2</script>ï¼Œç»“æœä¸º</li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/Grad-HE-Contrast.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/Grad-HE-Contrast-hist.jpg" alt="" /></p>

<ul>
  <li>å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹åˆ°å›¾åƒå¯¹æ¯”åº¦ç›¸æ¯”ä¹‹å‰æœ‰äº†è¾ƒå¤§çš„æå‡ï¼Œä»ç›´æ–¹å›¾ä¹Ÿå¯ä»¥çœ‹å‡ºå æœ‰å¤§éƒ¨åˆ†åƒç´ çš„æœ€é«˜æŸ±å­ä¸å†å æœ‰å¤§ç‰‡çš„ç°åº¦å€¼ï¼Œè¿™æ ·ä½¿å…¶ä»–åŒºåŸŸçš„å¯¹æ¯”åº¦å¾—åˆ°äº†å¢å¼ºã€‚</li>
</ul>

<h4 id="32-log-gradient">3.2 log Gradient</h4>

<ul>
  <li>è¿™ä¸ªæƒ³æ³•æ˜¯è§‚å¯Ÿåˆ°æœ‰çš„åƒç´ æ¢¯åº¦è¿‡å¤§ï¼Œä¸ºäº†æŠ‘åˆ¶å•ä¸ªåƒç´ æƒå€¼è¿‡å¤§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<script type="math/tex">\log(gradient+1)</script>çš„æ–¹å¼æ›¿ä»£æ¢¯åº¦ã€‚ç»“åˆæ‹†åˆ†æ–¹å¼<script type="math/tex">2.2</script>ï¼Œæœ€åç»“æœä¸º</li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/logGrad-HE-Contrast.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/logGrad-HE-Contrast-hist.jpg" alt="" /></p>

<ul>
  <li>å¯¹æ¯”<script type="math/tex">3.1</script>å¯ä»¥å‘ç°å›¾åƒæ•´ä½“äº®åº¦å¾—åˆ°æé«˜ï¼Œå¾ˆå¤šåŸæœ¬å®Œå…¨çœ‹ä¸åˆ°çš„ç»†èŠ‚ä¹Ÿå¼€å§‹å±•ç°å‡ºæ¥ã€‚å·²ç»è¾¾åˆ°äº†æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚</li>
</ul>

<h4 id="33-contrast-accumulated">3.3 CONTRAST-ACCUMULATED</h4>

<ul>
  <li>
    <p>è¿™ä¸ªæ–¹æ³•æ¥è‡ªè®ºæ–‡<a href="https://www.researchgate.net/publication/323349746_Contrast-accumulated_histogram_equalization_for_image_enhancement?enrichId=rgreq-3df2813a03f08e26ebb9c7759f0a5618-XXX&amp;enrichSource=Y292ZXJQYWdlOzMyMzM0OTc0NjtBUzo1OTg4OTc1NDYyNDAwMDFAMTUxOTc5OTcxMDA5Mg%3D%3D&amp;el=1_x_3&amp;_esc=publicationCoverPdf">CONTRAST-ACCUMULATED HISTOGRAM EQUALIZATION FOR IMAGE ENHANCEMENT</a></p>
  </li>
  <li>
    <p>å®é™…ä¸Šç®—æ³•çš„æ­¥éª¤å¾ˆç®€å•ï¼š(<script type="math/tex">S,L,\epsilon</script>ä¸ºé¢„è®¾å‚æ•°)</p>
  </li>
  <li>
    <p>ç¬¬ä¸€æ­¥ï¼šæŠŠå›¾ç‰‡<script type="math/tex">\mathbf A</script>ç­‰æ¯”ä¾‹ç¼©æ”¾ä½¿è¡Œã€åˆ—æ•°å°çš„ä¸º<script type="math/tex">S</script>å¾—åˆ°å›¾ç‰‡<script type="math/tex">\mathbf B_1</script>(æˆ‘å†™ä»£ç æ—¶ç›´æ¥è®©è¡Œæ•°ä¸º<script type="math/tex">S</script>)</p>
  </li>
  <li>
    <p>ç¬¬äºŒæ­¥ï¼šæŠŠå›¾ç‰‡<script type="math/tex">\mathbf B_1</script>åˆ—æ•°ã€è¡Œæ•°é™¤<script type="math/tex">2</script>å¾—åˆ°<script type="math/tex">\mathbf B_2</script>ï¼Œä»¥æ­¤ç±»æ¨ç›´åˆ°<script type="math/tex">\mathbf B_L</script>ã€‚</p>
  </li>
  <li>
    <p>ç¬¬ä¸‰æ­¥ï¼š</p>
  </li>
</ul>

<script type="math/tex; mode=display">\varphi_l(q)=-\sum_{q'\in \mathcal N(q)}\min\Big(\frac{\mathbf B_l(q)-\mathbf B_l(q')}{255},0\Big),(l=1,...,L)</script>

<ul>
  <li>
    <p>å…¶ä¸­<script type="math/tex">q</script>æ˜¯å›¾åƒä¸­çš„äºŒç»´åæ ‡ï¼Œ<script type="math/tex">\mathcal N(q)</script>æ˜¯<script type="math/tex">q</script>çš„æ›¼å“ˆé¡¿è·ç¦»ä¸‹çš„è¿‘é‚»ï¼Œè¿™é‡Œå–ä¸Šä¸‹å·¦å³å››ä¸ªã€‚</p>
  </li>
  <li>
    <p>ç¬¬å››æ­¥ï¼šå¯¹<script type="math/tex">\varphi_l(q)</script>é€šè¿‡åŒä¸‰æ¬¡æ’å€¼å˜æ¢åˆ°åŸå›¾åƒ<script type="math/tex">\mathbf A</script>çš„å¤§å°ï¼Œè®°ä½œ<script type="math/tex">\varphi_l'(x,y)</script>ã€‚</p>
  </li>
  <li>
    <p>ç¬¬äº”æ­¥ï¼šæƒå€¼ä¸º</p>
  </li>
</ul>

<script type="math/tex; mode=display">\Phi(x,y)=\Bigg(\prod_{l=1}^L\max(\varphi_l'(x,y),\epsilon)\Bigg)^{\frac{1}{L}}</script>

<ul>
  <li>
    <p>æ ¹æ®ç»éªŒï¼Œ<script type="math/tex">S</script>å–<script type="math/tex">256</script>ï¼Œ<script type="math/tex">L</script>å–<script type="math/tex">4</script>ï¼Œ<script type="math/tex">\epsilon</script>å–<script type="math/tex">0.001</script>ã€‚</p>
  </li>
  <li>
    <p>å¯ä»¥å¾—åˆ°<script type="math/tex">L</script>ä¸ª<script type="math/tex">\varphi_l(q)</script>é•¿è¿™æ ·</p>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/CACHE-DP-HE-Contrast-phi.jpg" alt="" /></p>

<ul>
  <li>ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ç»“åˆ<script type="math/tex">2.2</script>ï¼Œæœ€åç»“æœä¸º</li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/CACHE-DP-HE-Contrast.jpg" alt="" /></p>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/CACHE-DP-HE-Contrast-hist.jpg" alt="" /></p>

<ul>
  <li>
    <p>å¯¹äºè¿™å¹…å›¾ï¼Œè¯¥ç®—æ³•æœ€ç»ˆå’Œ<script type="math/tex">3.2</script>æ•ˆæœå·®ä¸å¤šã€‚</p>
  </li>
  <li>
    <p>è¿˜éœ€è¦æ³¨æ„çš„æ˜¯<script type="math/tex">\varphi(q)</script>å‡½æ•°çš„å½¢å¼ä¹Ÿæ˜¯å¯ä»¥å˜æ¢çš„ï¼Œå½“å‰è¿™ç§å½¢å¼æ˜¯è®¤ä¸ºæŸäº›é‡è¦çš„ä¿¡æ¯å¾€å¾€éšè—åœ¨é»‘è‰²ä¸­çš„ï¼Œå¦‚æœè®¤ä¸ºé‡è¦ä¿¡æ¯å¾€å¾€éšè—åœ¨ç™½è‰²ä¸­ï¼Œå¯ä»¥ä¿®æ”¹<script type="math/tex">\varphi</script>å‡½æ•°å¦‚ä¸‹</p>
  </li>
</ul>

<script type="math/tex; mode=display">\varphi_l(q)=\sum_{q'\in \mathcal N(q)}\max\Big(\frac{\mathbf B_l(q)-\mathbf B_l(q')}{255},0\Big),(l=1,...,L)</script>

<ul>
  <li>å¦å¤–è¿˜æœ‰ä¸€èˆ¬å½¢å¼ï¼šï¼ˆæˆ‘è„‘è¡¥çš„ï¼Œä¸ä¸€å®šæ­£ç¡®ï¼‰</li>
</ul>

<script type="math/tex; mode=display">\varphi_l(q)=\frac{\vert\mathbf B_l(q_{left})-\mathbf B_l(q_{right})\vert+\vert\mathbf B_l(q_{top})-\mathbf B_l(q_{down})\vert}{255},(l=1,...,L)</script>

<h2 id="4é¢„å¤„ç†">4.é¢„å¤„ç†</h2>

<ul>
  <li>
    <p>åœ¨è¯­éŸ³ä¿¡å·å¤„ç†ä¸­ï¼Œé¢„åŠ é‡æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„é¢„å¤„ç†æŠ€å·§ï¼Œäºæ˜¯æˆ‘åœ¨æƒ³æ˜¯ä¸æ˜¯å›¾åƒä¹Ÿå¯ä»¥é¢„åŠ é‡ï¼Œå°±æ˜¯æŠŠé«˜é¢‘åˆ†é‡åŠ å¼ºï¼Œä½é¢‘åˆ†é‡æŠ‘åˆ¶ã€‚æˆ‘åªæ˜¯åšäº†ä¸€ä¸ªç®€å•çš„å°è¯•ï¼Œé¦–å…ˆåšäºŒç»´å‚…é‡Œå¶å˜æ¢ï¼Œç„¶åç›´æ¥æ ¹æ®é¢‘è°±ä½ç½®<script type="math/tex">x,y</script>åˆ°ä¸­å¿ƒçš„å½’ä¸€åŒ–è·ç¦»åŠ ä¸Š<script type="math/tex">0.5</script>ä½œä¸ºæ»¤æ³¢æƒå€¼ã€‚</p>
  </li>
  <li>
    <p>æœ€åçš„å¯¹æ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå·¦ä¾§æ²¡æœ‰é¢„å¤„ç†ï¼Œå³ä¾§æ˜¯é¢„å¤„ç†åå†æ‰§è¡Œç®—æ³•çš„</p>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/chongjg/chongjg.github.io/master/img/Contrast-enhancement/add-freq.jpg" alt="" /></p>

<ul>
  <li>å¯èƒ½è¿™ä¹ˆå¯¹æ¯”ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯åœ¨ç”µè„‘ä¸Šé‡åˆä¸¤å¹…å›¾ç‰‡ä¸æ–­åˆ‡æ¢æ—¶ï¼Œèƒ½å¤Ÿå¾ˆæ˜æ˜¾åœ°çœ‹åˆ°å³ä¾§çš„å›¾ç‰‡ç»†èŠ‚éƒ¨åˆ†å˜æ¸…æ™°äº†ã€‚å¯ä»¥ä»”ç»†è§‚å¯Ÿæ ‘å¹²ä¸Šçš„çº¹ç†ï¼Œå³ä¾§å›¾ç‰‡çš„çº¹ç†æ˜¯è¦æ¯”å·¦ä¾§æ¸…æ™°å¾ˆå¤šçš„ã€‚å½“ç„¶ä¹Ÿæœ‰ä¸€ç‚¹å°±æ˜¯å›¾åƒçš„å™ªå£°ä¹Ÿè¢«å¢å¼ºäº†ï¼Œçœ‹èµ·æ¥çš„æ„Ÿè§‰å°±å¥½åƒæ˜¯ï¼šå·¦ä¾§çš„å›¾åƒæ˜¯å³ä¾§çš„å›¾åƒåšä¸€ä¸ªå¹³æ»‘æ»¤æ³¢ã€‚</li>
</ul>

<h2 id="5æ€»ç»“">5.æ€»ç»“</h2>

<ul>
  <li>
    <p>æ€»çš„æ¥è¯´ï¼Œç†è®ºä¸Šæ•ˆæœæœ€å¥½çš„æ­é…åº”è¯¥æ˜¯ï¼šé¢‘åŸŸé¢„å¤„ç†+æ‹†åˆ†æ–¹æ³•<script type="math/tex">2.2</script>+æƒå€¼æ–¹æ³•<script type="math/tex">3.3</script>ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ¡ˆçš„æ—¶é—´æ•ˆç‡æ˜¯æ¯”è¾ƒä½çš„ã€‚</p>
  </li>
  <li>
    <p>é¢‘åŸŸé¢„å¤„ç†æ—¶é—´å¤æ‚åº¦ï¼š<script type="math/tex">O(MN\log(MN))</script></p>
  </li>
  <li>
    <p>æ‹†åˆ†<script type="math/tex">2.1</script>åŠ<script type="math/tex">2.2</script>æ—¶é—´å¤æ‚åº¦ï¼š<script type="math/tex">O(MNm^2)</script>ï¼Œ<script type="math/tex">m</script>æ˜¯å‘¨å›´ç»Ÿè®¡èŒƒå›´ã€‚</p>
  </li>
  <li>
    <p>æ‹†åˆ†<script type="math/tex">2.3</script>æ—¶é—´å¤æ‚åº¦ï¼š<script type="math/tex">O(MN\log(MN))</script></p>
  </li>
  <li>
    <p>æ¢¯åº¦æƒå€¼åŠå¯¹æ•°æ¢¯åº¦æƒå€¼æ—¶é—´å¤æ‚åº¦ï¼š<script type="math/tex">O(MNl^2)</script>ï¼Œ<script type="math/tex">l</script>æ˜¯è®¡ç®—æ¢¯åº¦çš„å·ç§¯æ ¸å¤§å°ã€‚</p>
  </li>
  <li>
    <p><strong>CACHE</strong>æ—¶é—´å¤æ‚åº¦ï¼š<script type="math/tex">O(MNL)</script>ï¼Œå¸¸æ•°æ¯”è¾ƒå¤§ã€‚</p>
  </li>
  <li>
    <p>ä¸‹é¢ä¸ºä½¿ç”¨MATLABæ¯ç§ç»„åˆè¿è¡Œ100æ¬¡çš„å¹³å‡æ—¶é—´</p>
  </li>
</ul>

<table>
	<tr>
	    <td colspan="2" rowspan="3"> </td>
	    <td colspan="6">æ‹†åˆ†ç®—æ³•</td>
	</tr>
	<tr>
		<td colspan="2">HE</td>
		<td colspan="2">Voting</td>
		<td colspan="2">Contrast</td>
	</tr>
	<tr>
		<td>ä¸å¤„ç†</td>
		<td>é¢„å¤„ç†</td>
		<td>ä¸å¤„ç†</td>
		<td>é¢„å¤„ç†</td>
		<td>ä¸å¤„ç†</td>
		<td>é¢„å¤„ç†</td>
	</tr>
	<tr>
	    <td rowspan="4">æƒå€¼ç®—æ³•</td>
	    <td> å…¨ç›¸ç­‰</td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	</tr>
	<tr>
	    <td> Grad</td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	</tr>
	<tr>
	    <td> logGrad</td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	</tr>
	<tr>
	    <td> CACHE</td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	    <td> </td>
	</tr>
	
</table>

<h2 id="6å‚è€ƒ">6.å‚è€ƒ</h2>

<p>[1] <a href="https://www.researchgate.net/publication/224209864_Image_Contrast_Enhancement_using_Bi-Histogram_Equalization_with_Neighborhood_Metrics?enrichId=rgreq-319bc3ef6eb4fa0f9f562c5ffd925e65-XXX&amp;enrichSource=Y292ZXJQYWdlOzIyNDIwOTg2NDtBUzo0NTY1MTE5MTU4NTk5NjhAMTQ4NTg1MjMzMDAzOQ%3D%3D&amp;el=1_x_3&amp;_esc=publicationCoverPdf">Image Contrast Enhancement using Bi-Histogram Equalization with Neighborhood Metrics</a></p>

<p>[2] <a href="https://www.researchgate.net/publication/323349746_Contrast-accumulated_histogram_equalization_for_image_enhancement?enrichId=rgreq-3df2813a03f08e26ebb9c7759f0a5618-XXX&amp;enrichSource=Y292ZXJQYWdlOzMyMzM0OTc0NjtBUzo1OTg4OTc1NDYyNDAwMDFAMTUxOTc5OTcxMDA5Mg%3D%3D&amp;el=1_x_3&amp;_esc=publicationCoverPdf">CONTRAST-ACCUMULATED HISTOGRAM EQUALIZATION FOR IMAGE ENHANCEMENT</a></p>

<h2 id="7é™„å½•">7.é™„å½•</h2>

<ul>
  <li>matlabä»£ç </li>
</ul>

<pre><code class="language-MATLAB">% main.m
clc;
clear all;
close all;

img = imread('dark_road_5.jpg');

% Phi = ones(size(img));
% Phi = CACHE_BP(img);
% Phi = CACHE_RG(img);
% Phi = CACHE_DP(img);
% Phi = Grad(img);
% Phi = logGrad(img);

% pic = GHE(img, Phi);
% pic = HE_Voting(img, Phi);
% pic = HE_Contrast(img, Phi);
% pic = HE_Neighborhood(img);
% imwrite(pic, 'results/d-2.jpg');
</code></pre>

<pre><code class="language-MATLAB">% GHE.m
function [output] = GHE(img, Phi)
%% Global Histogram Equalization
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

cnt = zeros(1, 256);
[n, m] = size(img);
for i = 1 : n
    for j = 1 : m
        cnt(img(i, j) + 1) = cnt(img(i, j) + 1) + Phi(i, j);
    end
end

index = zeros(1, 256);
D = sum(cnt, 'all') / 256 + 1e-5;
j = 0;
for i = 1 :256
    index(i) = floor(j / D);
    j = j + cnt(i);
end

output = uint8(index(img + 1));

%% figure
figure;
set(gcf, 'outerposition', get(0, 'screensize'));

subplot(2, 2, 1);
histogram(img);
axis([0 255 0 inf]);
title('histogram(origin)', 'FontSize', 18);
subplot(2, 2, 3);
imshow(img);
title('image(origin)', 'FontSize', 18);

subplot(2, 2, 2);
histogram(output);
axis([0 255 0 inf]);
title('histogram(GHE)', 'FontSize', 18);
subplot(2, 2, 4);
imshow(output);
title('image(GHE)', 'FontSize', 18);
</code></pre>

<pre><code class="language-MATLAB">% HE_Voting.m
function [output] = HE_Voting(img, Phi)
%% HE with Voting Metric
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

VotingRadius = 1;
VotingLevel = (VotingRadius * 2 + 1) ^ 2;

cnt = zeros(256, VotingLevel);
[n, m] = size(img);

Vote = ones(n, m);

for i = 1 : n
    for j = 1 : m
        for ii = max(1, i - VotingRadius) : min(n, i + VotingRadius)
            for jj = max(1, j - VotingRadius) : min(m, j + VotingRadius)
                if(img(ii, jj) &lt; img(i, j))
                    Vote(i, j) = Vote(i, j) + 1;
                end
            end
        end
        cnt(img(i, j) + 1, Vote(i, j)) = cnt(img(i, j) + 1, Vote(i, j)) + Phi(i, j);
    end
end

index = zeros(256, VotingLevel);
D = sum(cnt, 'all') / 256 + 1e-5;
k = 0;
for i = 1 :256
    for j = 1 : VotingLevel
        index(i, j) = floor(k / D);
        k = k + cnt(i, j);
    end
end

for i = 1 : n
    for j = 1 : m
        output(i, j) = uint8(index(img(i, j) + 1, Vote(i, j)));
    end
end

%% figure
figure;
set(gcf, 'outerposition', get(0, 'screensize'));

subplot(2, 2, 1);
histogram(img);
axis([0 255 0 inf]);
title('histogram(origin)', 'FontSize', 18);
subplot(2, 2, 3);
imshow(img);
title('image(origin)', 'FontSize', 18);

subplot(2, 2, 2);
histogram(output);
axis([0 255 0 inf]);
title('histogram(HE Voting Metric)', 'FontSize', 18);
subplot(2, 2, 4);
imshow(output);
title('image(HE Voting Metric)', 'FontSize', 18);
</code></pre>

<pre><code class="language-MATLAB">% HE_Contrast.m
function [output] = HE_Contrast(img, Phi)
%% HE with Voting Metric and contrast difference metric
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

VotingRadius = 1;
VotingLevel = (VotingRadius * 2 + 1) ^ 2;

Threshold = 10;
cnt_Rank = 3;

cnt = zeros(256, VotingLevel, cnt_Rank);
[n, m] = size(img);

Vote = ones(n, m);
RVote = zeros(n, m);
Lad = zeros(n, m);
Rad = zeros(n, m);

Rank_Contrast = zeros(n, m);

for i = 1 : n
    for j = 1 : m
        for ii = max(1, i - VotingRadius) : min(n, i + VotingRadius)
            for jj = max(1, j - VotingRadius) : min(m, j + VotingRadius)
                if(img(ii, jj) &lt; img(i, j))
                    Vote(i, j) = Vote(i, j) + 1;
                    Lad(i, j) = Lad(i, j) + img(i, j) - img(ii, jj);
                elseif(img(ii, jj) &gt; img(i, j))
                    RVote(i, j) = RVote(i, j) + 1;
                    Rad(i, j) = Rad(i, j) + img(ii, jj) - img(i, j);
                end
                if(Vote(i, j) &gt; 1)
                    Lad(i, j) = Lad(i, j) / (Vote(i, j) - 1);
                end
                if(RVote(i, j) &gt; 0)
                    Rad(i, j) = Rad(i, j) / RVote(i, j);
                end
                if(Lad(i, j) &lt; Threshold &amp;&amp; Threshold &lt; Rad(i, j))
                    Rank_Contrast(i, j) = 1;
                elseif(Lad(i, j) &gt; Threshold &amp;&amp; Threshold &gt; Rad(i, j))
                    Rank_Contrast(i, j) = 3;
                else
                    Rank_Contrast(i, j) = 2;
                end
            end
        end
        cnt(img(i, j) + 1, Vote(i, j), Rank_Contrast(i, j)) = cnt(img(i, j) + 1, Vote(i, j), Rank_Contrast(i, j)) + Phi(i, j);
    end
end

index = zeros(256, VotingLevel, cnt_Rank);
D = sum(cnt, 'all') / 256 + 1e-5;
k = 0;
for i = 1 :256
    for j = 1 : VotingLevel
        for r = 1 : cnt_Rank
            index(i, j, r) = floor(k / D);
            k = k + cnt(i, j, r);
        end
    end
end

for i = 1 : n
    for j = 1 : m
        output(i, j) = uint8(index(img(i, j) + 1, Vote(i, j), Rank_Contrast(i, j)));
    end
end

%% figure
figure;
set(gcf, 'outerposition', get(0, 'screensize'));

subplot(2, 2, 1);
histogram(img);
axis([0 255 0 inf]);
title('histogram(origin)', 'FontSize', 18);
subplot(2, 2, 3);
imshow(img);
title('image(origin)', 'FontSize', 18);

subplot(2, 2, 2);
histogram(output);
axis([0 255 0 inf]);
title('histogram(HE Voting&amp;Contrast Metric)', 'FontSize', 18);
subplot(2, 2, 4);
imshow(output);
title('image(HE Voting&amp;Contrast Metric)', 'FontSize', 18);
</code></pre>

<pre><code class="language-MATLAB">% HE_Neighborhood.m
function [output] = HE_Neighborhood(img)
%% HE with Neighborhood Metric
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

NeighborRadius = 1;

[n, m] = size(img);

pixels = zeros(n * m, 4);
cnt = 1;

for i = 1 : n
    for j = 1 : m
        s = 0;
        for ii = max(1, i - NeighborRadius) : min(n, i + NeighborRadius)
            for jj = max(1, j - NeighborRadius) : min(m, j + NeighborRadius)
                if(img(ii, jj) &lt; img(i, j))
                    s = s + img(i, j) - img(ii, jj);
                end
            end
        end
        pixels(cnt, :) = [double(img(i, j)), double(s), i, j];
        cnt = cnt + 1;
    end
end

pixels = sortrows(pixels);

D = n * m / 256 + 1e-5;
output = uint8(zeros(n, m));
output(pixels(1, 3), pixels(1, 4)) = 0;

for i = 2 : n * m
    if(pixels(i, 1) == pixels(i - 1, 1) &amp;&amp; pixels(i, 2) == pixels(i - 1, 2))
        output(pixels(i, 3), pixels(i, 4)) = output(pixels(i - 1, 3), pixels(i - 1, 4));
    else
        output(pixels(i, 3), pixels(i, 4)) = floor(i / D);
    end
end

%% figure
figure;
set(gcf, 'outerposition', get(0, 'screensize'));

subplot(2, 2, 1);
histogram(img);
axis([0 255 0 inf]);
title('histogram(origin)', 'FontSize', 18);
subplot(2, 2, 3);
imshow(img);
title('image(origin)', 'FontSize', 18);

subplot(2, 2, 2);
histogram(output);
axis([0 255 0 inf]);
title('histogram(HE Neighborhood Metric)', 'FontSize', 18);
subplot(2, 2, 4);
imshow(output);
title('image(HE Neighborhood Metric)', 'FontSize', 18);
</code></pre>

<pre><code class="language-MATLAB">% Grad.m
function [output] = Grad(img)
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

kernal1 = [1 2 1
           0 0 0
          -1 -2 -1];
kernal2 = kernal1';

dif1 = conv2(img, kernal1);
dif2 = conv2(img, kernal2);

dif1 = dif1(2:end-1, 2:end-1);
dif2 = dif2(2:end-1, 2:end-1);

output = (dif1 .* dif1 + dif2 .* dif2) .^ 0.5;
</code></pre>

<pre><code class="language-MATLAB">% logGrad.m
function [output] = Grad(img)
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

kernal1 = [1 2 1
           0 0 0
          -1 -2 -1];
kernal2 = kernal1';

dif1 = conv2(img, kernal1);
dif2 = conv2(img, kernal2);

dif1 = dif1(2:end-1, 2:end-1);
dif2 = dif2(2:end-1, 2:end-1);

output = log(1 + (dif1 .* dif1 + dif2 .* dif2) .^ 0.5);
</code></pre>

<pre><code class="language-MATLAB">% CACHE_DP.m
function [output] = CACHE_DP(img)
%% Contrast Accumulated Histogram Equalization
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

[n, m] = size(img);
output = ones(n, m);

L = 4;
S = 256;
eps = 1e-3;

A = cell(1, L);
phi = cell(1, L);

img = im2double(img);

for i = 1 : L
    A{i} = imresize(img, [S, round(m * S / n)]);
    S = S / 2;
end

to = [1, 0; -1 0; 0 1; 0 -1];
for l = 1 : L
    [N, M] = size(A{l});
    phi{l} = zeros(N, M);
    for i = 1 : N
        for j = 1 : M
            for k = 1 : 4
                ii = i + to(k, 1);
                jj = j + to(k, 2);
                if(ii &lt; 1 || ii &gt; N || jj &lt; 1 || jj &gt; M)
                    continue;
                end
                phi{l}(i, j) = phi{l}(i, j) - min(A{l}(i, j) - A{l}(ii, jj), 0);
            end
        end
    end
    output = output .* max(imresize(phi{l}, [n, m]), eps);
end

output = output .^ (1 / L);
</code></pre>

<pre><code class="language-MATLAB">% CACHE_BP.m
function [output] = CACHE_DP(img)
%% Contrast Accumulated Histogram Equalization
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

[n, m] = size(img);
output = ones(n, m);

L = 4;
S = 256;
eps = 1e-3;

A = cell(1, L);
phi = cell(1, L);

img = im2double(img);

for i = 1 : L
    A{i} = imresize(img, [S, round(m * S / n)]);
    S = S / 2;
end

to = [1, 0; -1 0; 0 1; 0 -1];
for l = 1 : L
    [N, M] = size(A{l});
    phi{l} = zeros(N, M);
    for i = 1 : N
        for j = 1 : M
            for k = 1 : 4
                ii = i + to(k, 1);
                jj = j + to(k, 2);
                if(ii &lt; 1 || ii &gt; N || jj &lt; 1 || jj &gt; M)
                    continue;
                end
                phi{l}(i, j) = phi{l}(i, j) + max(A{l}(i, j) - A{l}(ii, jj), 0);
            end
        end
    end
    output = output .* max(imresize(phi{l}, [n, m]), eps);
end

output = output .^ (1 / L);
</code></pre>

<pre><code class="language-MATLAB">% CACHE_RG.m
function [output] = CACHE_DP(img)
%% Contrast Accumulated Histogram Equalization
if(numel(size(img)) &gt; 2)
    img = rgb2gray(img);
end

[n, m] = size(img);
output = ones(n, m);

L = 4;
S = 256;
eps = 1e-3;

A = cell(1, L);
phi = cell(1, L);

img = im2double(img);

for i = 1 : L
    A{i} = imresize(img, [S, round(m * S / n)]);
    S = S / 2;
end

to = [1, 0; -1 0; 0 1; 0 -1];
for l = 1 : L
    [N, M] = size(A{l});
    phi{l} = zeros(N, M);
    for i = 1 : N
        for j = 1 : M
            if(i - 1 &gt;= 1 &amp;&amp; i + 1 &lt;= N)
                phi{l}(i, j) = phi{l}(i, j) + abs(A{l}(i + 1, j) - A{l}(i - 1, j));
            end
            if(j - 1 &gt;= 1 &amp;&amp; j + 1 &lt;= M)
                phi{l}(i, j) = phi{l}(i, j) + abs(A{l}(i, j + 1) - A{l}(i, j - 1));
            end
        end
    end
    output = output .* max(imresize(phi{l}, [n, m]), eps);
end

output = output .^ (1 / L);
</code></pre>

:ET